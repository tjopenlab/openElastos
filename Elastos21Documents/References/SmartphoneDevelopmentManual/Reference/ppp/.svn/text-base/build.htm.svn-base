<!--==========================================================================-->
<!-- Copyright (c) 2000-2007,  Elastos, Inc.  All Rights Reserved.-->
<!--==========================================================================-->

<htmll>
<head>
<title>PPP协议</title>
<meta http-equiv="Content-Type" content="text/xmll; charset=gb2312">
<script src="/xsl/docstyles.js"></script>
</head>

<body>

<h2>PPP链路建立的过程 </h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;为了通过点对点链路建立通信，PPP链路的每一端，必须首先发送LCPpackets以便设定和测试数据链路。在链路建立之后，peer才可以被认证。然后，PPP必须发送NCPpackets以便选择和设定一个或更多的网络层协议。一旦每个被选择的网络层协议都被设定好了，来自每个网络层协议的datagrams就能在连路上发送了。链路将保持通信设定不变，直到外在的LCP和NCP关闭链路，或者是发生一些外部事件的时候（休止状态的定时器期满或者网络管理员干涉）。 </p>
<h3>1.链路死亡（物理连接不存在） </h3>
    <p>&nbsp;&nbsp;&nbsp;&nbsp;链路一定开始并结束于这个阶段。当一个外部事件（例如载波侦听或网络管理员设定）指出物理层已经准备就绪时，PPP将进入链路建立阶段。在这个阶段，LCP自动机器将处于初始状态，向链路建立阶段的转换将给LCP自动机器一个UP事件信号。 </p>
<h3>2.链路建立阶段 </h3>
    <p>&nbsp;&nbsp;&nbsp;&nbsp;LCP负责创建链路。在这个阶段，将对基本的通讯方式进行选择。链路两端设备通过LCP向对方发送配置信息报文（Configure Packets）。一旦一个配置成功信息包（Configure-Ack packet）被发送且被接收，就完成了交换，进入了LCP开启状态。应当注意，在链路创建阶段，只是对验证协议进行选择，用户验证将在第3阶段实现 </p>
<h3>3.认证阶段 </h3>
    <p>&nbsp;&nbsp;&nbsp;&nbsp;在这个阶段，客户端会将自己的身份发送给远端的接入服务器。该阶段使用一种安全验证方式避免第三方窃取数据或冒充远程客户接管与客户端的连接。在认证完成之前，禁止从认证阶段前进到网络层协议阶段。如果认证失败，认证者应该跃迁到链路终止阶段。</p>
    <p>&nbsp;&nbsp;&nbsp;&nbsp;在这一阶段里，只有链路控制协议、认证协议，和链路质量监视协议的packets是被允许的。在该阶段里接收到的其他的packets必须被静静的丢弃。</p>
    <p>&nbsp;&nbsp;&nbsp;&nbsp;最常用的认证协议有口令验证协议（PAP）和挑战握手验证协议（CHAP）.</p>
    <p>认证方式:</p>
    <p>（1）口令验证协议（PAP）:</p>
    <p>&nbsp;&nbsp;&nbsp;&nbsp;PAP是一种简单的明文验证方式。NAS（网络接入服务器，Network Access Server）要求用户提供用户名和口令，PAP以明文方式返回用户信息。很明显，这种验证方式的安全性较差，第三方可以很容易的获取被传送的用户名和口令，并利用这些信息与NAS建立连接获取NAS提供的所有资源。所以，一旦用户密码被第三方窃取，PAP无法提供避免受到第三方攻击的保障措施。 </p>
    <p>（2）挑战-握手验证协议（CHAP）:</p>
    <p>&nbsp;&nbsp;&nbsp;&nbsp;CHAP是一种加密的验证方式，能够避免建立连接时传送用户的真实密码。NAS向远程用户发送一个挑战口令（challenge），其中包括会话ID和一个任意生成的挑战字串 （arbitrary challengestring）。远程客户必须使用MD5单向哈希算法（one-way hashing algorithm）返回用户名和加密的挑战口令，会话ID以及用户口令，其中用户名以非哈希方式发送 </p>
    <p>&nbsp;&nbsp;&nbsp;&nbsp;CHAP对PAP进行了改进，不再直接通过链路发送明文口令，而是使用挑战口令以哈希算法对口令进行加密。因为服务器端存有客户的明文口令，所以服务器可以重复客户端进行的操作，并将结果与用户返回的口令进行对照。CHAP为每一次验证任意生成一个挑战字串来防止受到再现攻 击（replay attack）。在整个连接过程中，CHAP将不定时的向客户端重复发送挑战口令，从而避免第3方冒充远程客户（remote client impersonation）进行攻击。 </p>
<h3>4.网络层协议阶段 </h3>
    <p>&nbsp;&nbsp;&nbsp;&nbsp;认证阶段完成之后，PPP将调用在链路创建阶段（阶段1）选定的各种网络控制协议（NCP）。选定的NCP解决PPP链路之上的高层协议问题，例如，在该阶段IP控制协议（IPCP）可以向拨入用户分配动态地址。 </p>
    <p>&nbsp;&nbsp;&nbsp;&nbsp;这样，经过三个阶段以后，一条完整的PPP链路就建立起来了。 </p>
<script>footer("chinese")</script>
</body>
</html>