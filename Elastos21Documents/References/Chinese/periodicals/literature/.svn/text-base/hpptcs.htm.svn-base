<!--==========================================================================-->
<!-- Copyright (c) 2000-2006,  Elastos, Inc.  All Rights Reserved.-->
<!--==========================================================================-->

<html>
<head>
<title>陈志成:基于Elastos操作系统的高压大功率变频器控制系统</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<script src="/xsl/docstyles.js"></script>
</head>

<body>
   
    <h2><center>基于Elastos操作系统的高压大功率变频器控制系统[1]</center></h2>
    <center>陈志成，何华灿</center>
    <center>(西北工业大学计算机科学与工程系，710072)</center>
    <center>陈  榕，刘艺平</center>
    <center>(北京科泰世纪科技有限公司，100029)</center>
    
    <h4>摘  要:</h4>
        <p>"Elastos"是我国自主版权的基于中间件技术的下一代因特网操作系统，目前已经在工业控制、医疗设备、手持设备等行业得到应用。文章在分析"Elastos"的基本特征及其构件技术的基础上，设计开发了"基于Elastos操作系统的高压大功率变频器控制系统"。应用表明：该系统具有友好的人机界面、较强的稳定性与实时性、强大的故障警报与处理功能、良好的远程调试与监控机制。</p>
    
    <h4>关键字:</h4>
        <p>因特网操作系统，Elastos操作系统，构件技术，变频器，远程监控</p>
    
    <p>中图分类号：TP302.1   文献标识码：A</p>    
    
    <h3>1. 背景</h3>
        <p>随着计算机网络技术的普及和发展，其应用发展趋势是从桌面应用向网络应用的转移。人们从网上获得的不仅是信息，还包括程序、交互式应用。这种新的网络应用环境带来了新的运算模型：应用程序可以由多厂家产品组合而成；跨平台、跨设备的网络应用模式；浏览器成为实现这种组合并且能够相互操作的框架与平台；而其兼容性由网络标准技术实现。</p>
        <p>在工业控制领域，各种智能化设备的控制系统也逐渐从单道程序向多进程与多线程、从简单的控制软件到复杂的操作系统发展，其软件编程模型也正在从面向结构、面向对象、到面向中间件的发展。但其开发手段不少还是效率较低的"手工作坊"形式。为了缩短软件开发周期，提高系统的稳定性和可维护性，在改造和提升传统工业控制系统的技术开发中亟需导入先进的软件开发手段。</p>
        <p>北京科泰世纪科技有限公司推出的"Elastos"操作系统（英文名称为Zyco），是面向构件、以元数据运算模型为基础的下一代因特网操作系统[1]，已被列入国家863"十五"计划中的基础软件平台研发重点项目。成都东方凯奇电气有限责任公司是我国目前为数不多的集研究与制造无电网污染高压大功率变频器的单位之一。上述两家公司进行了"在工业控制领域导入软件的工厂化生产技术"课题的合作研究，研发了"基于Elastos操作系统的高压大功率变频器控制系统（简写为HPTCS）"，本文作者一直参与其结构设计与代码编写。文章在分析Elastos的基本特征及其构件技术的基础上，详细介绍了HPTCS的结构设计与功能应用。</p>

    <h3>2. Elastos系统及其基本特征</h3>
        <h4>2.1 Elastos简介及其构件技术</h4>
            <p>"Elastos"是下一代因特网操作系统，如图一所示。"常驻内核"和"系统服务"构成了底层的灵活内核执行平台，实现了相当于传统的32位实时操作系统的功能：微内核、模块化结构、多进程、多线程、多优先级实时中断处理；支持虚拟存储管理、文件管理、网络设备等。</p>
            <p>"Elastos"创新性地实现了与微软COM[2,3]构件技术兼容的"EzCOM构件技术"，提供了高效率的构件/中间件运行环境[4]。EzCOM建立在Elastos所提供的构件框架和后绑定等必要的运行支持环境之上，为上层的应用程序提供标准接口。"浏览器引擎"是构成浏览器或嵌入式浏览器的COM组件程序库，包括了支持开放的通信协议SOAP、XML、基本图形界面库，排版显示等。"应用程序引擎"可以是用户的COM组件库，或系统的其他组件库。基于EzCOM技术实现的Elastos操作系统具有高度模块化的系统结构，支持动态链接库DLL和动态加载应用程序，便于剪裁重组以适应不同嵌入式实时系统的需求，可实现硬件设备的即插即用。</p>
            <center><img src="images/hpptcs_fig1.bmp"></center>
            <center>图一: Elastos系统及其构件技术</center>
         <h4>2.2 Elastos的基本特征</h4>
            <p>概括来讲，Elastos操作系统的基本特征主要有以下几点：</p>
            <p>(1) 在嵌入式操作系统中导入了先进的EzCOM构件技术，提供软件工业化生产的手段，缩短应用产品开发周期，操作系统基于构件技术，其通用部件的灵活组合可以适应于不同的系统配置；</p>
            <p>(2) 应用程序构件可以独立升级、动态加载，硬件设备可以即插即用，网络资源可以自动获取，而这些功能均由操作系统自动支持，用户无需重新配置；</p>
            <p>(3) 界面友好的的交叉开发环境和源代码级远程调试工具，应用程序与Windows二进制兼容，不需仿真环境；</p>
            <p>(4) 利用创新的EzCOM技术和先进的中间件技术来实现Elastos的网络应用，这代表了下一代面向因特网应用的高性能操作系统的技术发展方向，并与Java、C#等最新的构件技术兼容与互补。</p>

    <h3>3. HPTCS的结构设计与系统功能</h3>
       <h4>3.1 HPTCS的结构设计</h4>
            <p>如图二所示，HPTCS主要由两个控制系统组成，一个是直接控制变频器机组运行的主控板系统；另一个是对整个系统进行管理和对参数进行操作的人机控制系统，而人机控制系统又分为现场控制与显示终端和远程调试与监控终端两个部分。工作人员既可以到现场观测变频器的运行状态，也可以坐在远程办公室里对其进行监控。</p>
            <center><img src="images/hpptcs_fig2.bmp"></center>
            <center>图二:  HPTCS的组成结构示意图</center>
        <h4>3.2 HPTCS的主要技术特征</h4>
            <p>基于Elastos的HPTCS控制系统除了继承Elastos操作系统的技术特征之外，还有适合于高压大功率变频器自身的特征，主要有以下几点：</p>
            <p>(1) 构件编程、独立升级</p>
            <p>整个HPTCS系统全部利用EzCOM构件搭建而成，由于Elastos系统提供了相应的EzCOM构件库，而且在其图形开发环境中提供了诸如微软.net中的Button、Label、GroupBox、Menu等控件，这大大缩短了HPTCS的开发周期。系统运行时通过EzCOM中间件技术实现动态加载运行，因此所有的系统构件、应用构件都可以独立升级，无论所需的DLL库文件在本地还是远程，系统都可以自动检测并加载。HPTCS中主要的动态加载构件库有：操作系统构件库ZycoSys.dll，驱动程序构件库ZycoDrv.dll，字体构件库ZycoFont.dll，图形构件库ZycoGdi.dll，主控板系统构件库MainCtrl.dll，实时操作构件库RealTime.dll，远程监控构件库RemotSys.dll，故障警报构件库Trbalarm.dll，整个应用程序入口的执行文件为HPTCS.dll。如果某个构件库需要升级，则只需要更换该构件库文件，而应用程序和其它构件库无需重写，也无需重编译。</p>    
            <p>(2) 应用程序跨多平台、二进制兼容</p>
            <p>HPTCS应用程序在技术人员熟悉的Windows环境下开发与调试，其二进制代码可以分别在Windows系统，VB环境，HTML浏览器及Zyco Elastos系统中运行，实现了跨多平台的二进制兼容，这主要是得益于EzCOM中间件技术。</p>
            <p>(3) 多线程实时控制与远程调试</p>
            <p>HPTCS系统的工作流程如图三所示。在正常工作时除了主线程之外，还有串口守护线程、键盘守护线程、鼠标守护线程、网络守护线程，这些线程负责接收、处理、分发相应设备的事件请求，并与主线程进行数据交换，主线程负责人机界面部分，包括系统的状态显示、参数设置、实时监控、以及系统信息提示等。其中，HPTCS系统可以进行远程调试与监控，这是其最为先进的技术特征之一。</p>
            <center><img src="images/hpptcs_fig3.bmp"></center>
            <center>图三:  HPTCS的工作流程示意图</center>
            <p>(4) RS232/光纤通讯转换电路</p>
            <p>应用中的主控板系统与变频器机组之间的通讯介质选用光纤。为了应用熟悉的PC机对工控系统进行现场或远程的调试与监控，设计并自制了RS232串口与光纤通讯的转换电路版。</p>
            <p>(5) HPTCS的通讯协议</p>
            <p>根据高压大功率变频器的运行特征，为了实时控制的需要，并且考虑与以前的MCS96主控板系统的兼容，在主控板控制系统和现场控制系统之间的通讯采用了单字节传输的应答方式，在现场控制系统和远程监控终端之间采用TCP/IP和Modem协议。</p>
            <h4>3.3 HPTCS系统的功能模块</h4>
            <p>(1) 友好的用户界面</p>
            <p>传统的变频器控制系统是采用MCS96作为主控板部分，MCS51作为人机控制界面部分，没有远程监控功能，其显示屏分辨率只有 128 * 64 象素，显示的信息很有限，对某参数值的显示，只能显示简单的数字。基于Elastos开发的HPTCS系统可以安装在PC机上和Flash电子盘上，可以选用普通显示器和液晶显示器，而且可以设置所支持的各种分辨率。因此，HPTCS系统不仅界面美观，操作方便，而且在显示系统状态和各参数值的基础上，还可以绘制各参数值随时间的变化曲线。图四是HPTCS系统的人机界面之一。</p>
            <center><img src="images/hpptcs_fig4.bmp"></center>
            <center>图四:  HPTCS系统的人机界面之一</center>
            <p>(2) 状态显示与参数设置</p>
            <p>HPTCS系统可以实时显示变频器的运行状态，如运行频率、管网的实际压力等。HPTCS中的参数分为"系统参数"和"用户参数"两大类，工作人员可以随时查看各个参数值。但是，当要设置新的参数值时，系统要求提供系统密码。此外，工作人员在进行参数值设置时，HPTCS将自动进行参数范围的检查，合法的参数才传送给主控板系统，进而控制变频器机组的相关行为；对于超范围的参数值，HPTCS会给出提示信息，将不会生效。</p>
            <p>(3) 实时控制</p>
            <p>HPTCS系统的实时控制有：就地/远程、手动/自动，可以组合为四种控制方式，通过面板上相应的按钮进行切换。对于常用的"停机"、"复位"、"帮助"等都可以直接操作控制面板，也可以通过系统菜单进行操作。此外，由于Elastos操作系统的支持，还可以对各线程的优先级进行管理，Elastos系统支持256种优先级。</p>
            <p>(4) 故障报警与处理</p>
            <p>HPTCS系统在实时监控的基础上，提供了变频器运行故障的报警与处理功能。当主控板系统监控到变频器运行出现异常时，将在显示终端出现故障信息，并可以发声警报。HPTCS将根据故障类型分别进行相应处理，对于某些故障而言，HPTCS可以自动处理，并发给主控板系统相关命令，以使变频器调整至正常运行状态；对于另外一些模糊故障或比较严重的故障，HPTCS将自动检测是否连接有远程监控系统，如存在，则会通过网络启动远程的HPTCS系统，进行远程故障警报，并要求进行故障的调试。此外，所有故障的发生时间、故障设备、故障类型、处理方案等都记录在一个故障文件之中，以便工作人员查阅故障历史记录。</p>
            <p>(5) 远程调试与监控</p>
            <p> 远程调试与监控功能的启动来源于两个方面：一方面就是前面讲到的远程故障报警与调试；另一方面是：在远程的用户或工作人员想查看变频器当前的运行状态，那么他可以用因特网上的任何一台可用的电脑来访问变频器本地的监控系统，首先下载一个远程使用的HPTCS副本，安装在远程机上，然后运行HPTCS系统，根据菜单和提示操作即可实现对变频器运行状态的查询与监控。</p>
            <p>(6) 文件系统管理</p>
            <p>在传统的基于单片机的变频器控制系统中，参数值只能在屏幕上一个一个地查看，需要记录时必须手动抄下来。在HPTCS系统中，专门建立了一些文件，主要有参数记录文件、故障记录文件、操作记录文件、参数范围文件、HPTCS系统的功能介绍和使用说明的帮助文件。这些文件都存储在本地的磁盘中，在HPTCS运行期间可以通过菜单调出各相关文件。此外，这些文件都可以通过串口、并口、USB口、磁盘或网络进行输入或输出操作，便于工作人员对整个高压大功率变频器机组运行状况的分析和监控。</p>
            

    <h3>4. HPTCS的测试与应用</h3>
        <p>在Elastos操作系统基础上开发的高压大功率变频器控制系统HPTCS的测试版于2001年4月完成，在经过严格的现场测试和远程模拟测试后进行了试用。试用效果表明：HPTCS系统具有友好的人机界面，完整的帮助文档，较强的稳定性与实时性，其强大的故障处理功能和远程调试与监控功能得到同行业人员的好评。最近由于Elastos操作系统自身的升级和HPTCS系统添加新的功能，我们开发了HPTCS正式版，并于2002年5月正式投入实际应用。</p>
        
    <h3>5. 总结与展望</h3>
        <p>本文分析了我国自主版权的基于中间件技术的下一代因特网操作系统DD"Elastos"的基本特征,阐述了创新的EzCOM构件技术。与传统的编程模型相比较，基于Elastos操作系统开发应用程序的最大特征是：构件编程、周期短、构件独立升级、应用程序二进制跨多平台兼容、多线程与多进程实时控制、自动加载本地/远程构件。</p>
        <p>设计开发了基于Elastos操作系统的高压大功率变频器控制系统HPTCS，给出了HPTCS的结构设计与工作流程，分析了HPTCS的主要技术特征，详细介绍了HPTCS的功能模块及其应用。应用表明：HPTCS具有友好的人机界面，较强的稳定性与实时性，强大的故障警报与处理功能，良好的远程调试与监控机制。</p>
        <p>基于因特网技术的应用发展趋势是桌面应用向网络应用的转移，随着中间件技术的日趋完善，人们逐步认识到它的巨大潜力。"Elastos"是新兴的基于中间件技术的下一代因特网操作系统，它为软件的"工厂化生产"及"网络化应用"提供了一种新的平台，HPTCS是其在工业控制领域的应用案例之一，而关于"Elastos"自身的更多技术将随其应用而逐渐公开。为适应新时代的要求，操作系统的概念及其应用方式正在经历着重大的变化，这些变化将给计算机软件业带来前所未有的发展空间。</p>

    <h3><center>参考文献</center></h3>
        <p>1. 陈榕，因特网时代操作系统的演变（一），计算机世界，No.42，2001，10，B17~18。 </p>
        <p>2. [美]Dale Rogerson(著)，杨秀章，江英(译)，COM技术内幕，北京，清华大学出版社，1999.3，P1~240。 </p>
        <p>3. [美]Don Box（著），潘爱民（译），COM本质论，北京：中国电力出版社，2001，P1~184。</p>
        <p>4. Chen Rong，The application of middleware technology in embedded OS，Workshop on Embedded System，In conjunction with the ICYCS (6th) 2001.10，Hangzhou，P.R.China。</p>

    <h2><center>The high-pressure and powerful transducer control system based on Zyco operating system</center></h2>
    <center>Chen Zhicheng，He Huacan</center>
    <center>(Department of Computer Science and Engineering, Northwestern Polytechnical University，710072 Xi'an of China)</center>
    <center>Chen Rong，Liu Yiping</center>
    <center>(Coretac Century. Inc.，Beijing. 100029，Beijing of China)</center>
    
    <h4>Abstract：</h4>
        <p>Zyco is an Internet operating system of future generation, which is based on middleware technology, and has the independent copyright of our country. Now it has already received good applications in the trades, such as industrial control，living beings medical treatment, handheld device，etc. This paper analyses the essential feature of Zyco and the EzCOM technology, and design and realizing of high-pressure and powerful control system HPTCS. The application shows: The HPTCS system has friendly man-machine interface, strong stability and the real-time quality, good function for alarming and dealing with troubles, good mechanism for remote debugging and controlling.</p>
    
    <h4>Keywords：</h4>
        <p>Internet OS，Zyco OS，EzCOM，Transducer，Remote control。</p>
    
    <p>Category no：TP302.1   Identification code：A</p>
    
   <h3><center>附  录</center></h3>
        <p><b>作者简介</b></p>
        <p>陈志成： </p>
        <p>1973 年 09 月生，男，籍贯：四川渠县。西北工业大学计算机系"计算机软件与理论"专业博士生，主要研究方向有：嵌入式操作系统，分形与混沌中的泛逻辑。发表论文数篇。</p>
        <p>何华灿：</p>
        <P>1938 年 01 月生，男，籍贯：湖北荆沙。西北工业大学教授，博士生导师；中国人工智能协会副理事长。主要研究方向：人工智能基础及其应用，泛逻辑学与不确定性推理。出版专著《人工智能原理》及《泛逻辑学原理》。在核心刊物上发表论文数十篇，创立泛逻辑学。</P>
        <P>陈  榕：</P>
        <P>1957 年 06 月生，男，美籍华人，（籍贯：中国北京）。清华大学计算机软件专业本科，1984年公费出国，1987年获美国伊利诺大学硕士学位，并攻读博士课程。自1984年至1992在伊利诺大学计算中心工作，1992年－2000年在微软公司工作，任微软高级工程师，曾负责微软公司OLE、DCOM与COM+等项目研发，现任北京科泰世纪科技有限公司首席科学家。主要研究方向有：因特网操作系统，EzCOM构件技术，面向对象程序设计。</P>
        <P>刘艺平：</P>
        <P>1954 年 09 月生，男，美籍华人，（籍贯：中国安徽）。清华大学计算机软件专业本科、硕士。1982－1989年在清华大学计算中心工作，1989年赴德进修，1991年转赴美国，曾在Tandem、Netframe、Netscape公司工作，任网景公司高级工程师。曾负责Netscape2.0到4.0以及5.0Java版的核心开发等项目，2000年回国出任北京科泰世纪科技有限公司总工程师。主要研究方向有：因特网操作系统，网络浏览器技术，工业控制计算机。</P>                
<script>footer("chinese")</script>
</body>
</html>