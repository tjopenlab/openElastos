<!--==========================================================================-->
<!-- Copyright (c) 2000-2007,  Elastos, Inc.  All Rights Reserved.-->
<!--==========================================================================-->

<html>
<head>
<title>Í¼ÐÎ¿Ø¼þIListBox</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<script src="/xsl/docstyles.js"></script>
</head>

<body>

<h2> IListBox ·¶Àý³ÌÐò </h2>

<pre>
//==========================================================================
// Copyright (c) 2000-2007,  Elastos, Inc.  All Rights Reserved.
//==========================================================================

<h3> CListboxDemo.h </h3>
#include &quot;_CListboxDemo.h&quot;
class CListboxDemo : public _CListboxDemo
{
public:
    CListboxDemo();
    ~CListboxDemo();

    CARAPI AtEntry(
        /* [in] */ EzArray<WString> argcv);

    CARAPI OnClick(
        /* [in] */ IButton* pIObject);

    CARAPI OnClick2(
        /* [in] */ IButton* pIObject);

    CARAPI OnClick3(
        /* [in] */ IButton* pIObject);

    CARAPI AtExit();

    CARAPI OnClose(
        /* [in] */ IButton* pIObject);

private:
    IForm        * m_pMainForm;
    IListBox     * m_pIListbox1;
    IListBox     * m_pIListbox2;

    IButton      * m_pIButton;
    IButton      * m_pIButton2;
    IButton      * m_pIButton3;
    IButton      * m_pIBtnClose;
};

<h3> CListboxDemo.cpp </h3>
#include &quot;CListboxDemo.h&quot;
#include &quot;_CListboxDemo.cpp&quot;
#include &lt;stdio.h&gt;

CListboxDemo::CListboxDemo()
{
    m_pIBtnClose = NULL;
    m_pMainForm = NULL;
    m_pIListbox1 = NULL;
    m_pIListbox2 = NULL;
    m_pIButton = NULL;
    m_pIButton2 = NULL;
    m_pIButton3 = NULL;
}

CListboxDemo::~CListboxDemo()
{
    if (NULL != m_pMainForm) {
        m_pMainForm->Release();
    }

    if (NULL != m_pIListbox1) {
        m_pIListbox1->Release();
    }

    if (NULL != m_pIListbox2) {
        m_pIListbox2->Release();
    }

    if (NULL != m_pIButton) {
        m_pIButton->Release();
    }

    if (NULL != m_pIButton2) {
        m_pIButton2->Release();
    }

    if (NULL != m_pIButton3) {
        m_pIButton3->Release();
    }

    if (NULL != m_pIBtnClose) {
        m_pIBtnClose->Release();
    }
}

ECode CListboxDemo::AtEntry(
        /* [in] */ EzArray < WString > argcv)
{
    ECode ec;
///////////     form
    ec = CForm::New(&m_pMainForm);
    if (FAILED(ec)) {
        prInt32f("Create Form failed, the ec = 0x%08x\n", ec);
        return ec;
    }

    ec = m_pMainForm->Init(FormStyle_Gradient, L"MAIN", 0, 0, 240, 320, NULL);
    if (FAILED(ec)) {
        prInt32f("Init Form failed, the ec = 0x%08x\n", ec);
        return ec;
    }

//////////////  button
    ec = CButton::New(&m_pIButton);
    if (FAILED(ec)) {
        prInt32f("Create Button failed, the ec = 0x%08x\n", ec);
        return ec;
    }

    ec = m_pIButton->Init(ButtonStyle_Crystal, L"add",
                        10, 10, 50, 20, m_pMainForm);
    if (FAILED(ec)) {
        prInt32f("Init Button failed, the ec = 0x%08x\n", ec);
        return ec;
    }

    CButton::AddClickCallback(m_pIButton,
                 this, &CListboxDemo::OnClick);

////////////    button2
    ec = CButton::New(&m_pIButton2);
    if (FAILED(ec)) {
        prInt32f("Create Button2 failed, the ec = 0x%08x\n", ec);
        return ec;
    }

    ec = m_pIButton2->Init(ButtonStyle_Crystal, L"remove",
                        70, 10, 80, 20, m_pMainForm);
    if (FAILED(ec)) {
        prInt32f("Init Button2 failed, the ec = 0x%08x\n", ec);
        return ec;
    }
    CButton::AddClickCallback(m_pIButton2,
                 this, &CListboxDemo::OnClick2);

////////////    button3
    ec = CButton::New(&m_pIButton3);
    if (FAILED(ec)) {
        prInt32f("Create Button3 failed, the ec = 0x%08x\n", ec);
        return ec;
    }

    ec = m_pIButton3->Init(ButtonStyle_Crystal, L"Upate",
                        10, 290, 80, 20, m_pMainForm);
    if (FAILED(ec)) {
        prInt32f("Init Button3 failed, the ec = 0x%08x\n", ec);
        return ec;
    }

    CButton::AddClickCallback(m_pIButton3,
                 this, &CListboxDemo::OnClick3);

//////////////  listbox1
    ec = CListBox::New(&m_pIListbox1);
    if (FAILED(ec)) {
        prInt32f("Create Listbox1 failed, the ec = 0x%08x\n", ec);
        return ec;
    }

    ec = m_pIListbox1->Init(ControlStyle_VScroll|ControlStyle_HScroll|
                            ControlStyle_UserRender|
                            ListBoxStyle_GradientGround,
                            L"lb", 0, 60, 100, 210, m_pMainForm);
    if (FAILED(ec)) {
        prInt32f("Init Listbox1 failed, the ec = 0x%08x\n", ec);
        return ec;
    }

    ec = m_pIListbox1->InsertItem(0, L"1111111111");
    if (FAILED(ec)) {
        return ec;
    }
    ec = m_pIListbox1->InsertItem(1, L"2222222222");
    if (FAILED(ec)) {
        return ec;
    }
    ec = m_pIListbox1->InsertItem(2, L"3333333333");
    if (FAILED(ec)) {
        return ec;
    }
    ec = m_pIListbox1->InsertItem(3, L"4444444444");
    if (FAILED(ec)) {
        return ec;
    }
    ec = m_pIListbox1->InsertItem(4, L"5555555555");
    if (FAILED(ec)) {
        return ec;
    }
    ec = m_pIListbox1->InsertItem(5, L"6666666666");
    if (FAILED(ec)) {
        return ec;
    }

//////////////  listbox2
    ec = CListBox::New(&m_pIListbox2);
    if (FAILED(ec)) {
        prInt32f("Create Listbox2 failed, the ec = 0x%08x\n", ec);
        return ec;
    }

    ec = m_pIListbox2->Init(ControlStyle_VScroll|ControlStyle_HScroll|
                    ListBoxStyle_GradientGround,
                    L"lb", 140, 60, 100, 210,  m_pMainForm);
    if (FAILED(ec)) {
        prInt32f("Init Listbox2 failed, the ec = 0x%08x\n", ec);
        return ec;
    }

    ec = m_pIListbox2->InsertItem(0, L"1111111111");
    if (FAILED(ec)) {
        return ec;
    }
    ec = m_pIListbox2->InsertItem(1, L"2222222222");
    if (FAILED(ec)) {
        return ec;
    }
    ec = m_pIListbox2->InsertItem(2, L"3333333333");
    if (FAILED(ec)) {
        return ec;
    }
    ec = m_pIListbox2->InsertItem(3, L"4444444444");
    if (FAILED(ec)) {
        return ec;
    }
    ec = m_pIListbox2->InsertItem(4, L"5555555555");
    if (FAILED(ec)) {
        return ec;
    }
    ec = m_pIListbox2->InsertItem(5, L"6666666666");
    if (FAILED(ec)) {
        return ec;
    }

///////////////  Exit Button
    ec = CButton::New(&m_pIBtnClose);
    if (FAILED(ec)) {
        prInt32f("Create CloseButton failed, the ec = 0x%08x\n", ec);
        return ec;
    }

    ec = m_pIBtnClose->Init(0, L"Exit",
                160, 0, 80, 30, m_pMainForm);
    if (FAILED(ec)) {
        prInt32f("Init CloseButton failed, the ec = 0x%08x\n", ec);
        return ec;
   }

    CButton::AddClickCallback(m_pIBtnClose,
                 this, &CListboxDemo::OnClose);

    m_pMainForm->Show();

    return NOERROR;
}

ECode CListboxDemo::AtExit()
{
    return NOERROR;
}

ECode CListboxDemo::OnClick(
        /* [in] */ IButton* pIObject)
{
    ECode ec;

    ec = m_pIListbox2->InsertItem(0, L"xxxxxx");
    if (FAILED(ec)) {
        return ec;
    }
    ec = m_pIListbox1->InsertItem(0, L"xxxxxx");
    if (FAILED(ec)) {
        return ec;
    }

    return NOERROR;
}

ECode CListboxDemo::OnClick2(
        /* [in] */ IButton* pIObject)
{
    ECode ec;

    ec = m_pIListbox1->RemoveItem(0);
    if (FAILED(ec)) {
        return ec;
    }
    ec = m_pIListbox2->RemoveItem(0);
    if (FAILED(ec)) {
        return ec;
    }

    return NOERROR;
}

ECode CListboxDemo::OnClick3(
        /* [in] */ IButton* pIObject)
{
    ECode ec;

    ec = m_pIListbox1->Update();
    if (FAILED(ec)) {
        return ec;
    }

    return NOERROR;
}

ECode CListboxDemo::OnClose(
        /* [in] */ IButton* pIObject)
{
    m_pMainForm->Close();

    return NOERROR;
}

</pre>

<script>footer("KoreTide")</script>
</body>
</html>