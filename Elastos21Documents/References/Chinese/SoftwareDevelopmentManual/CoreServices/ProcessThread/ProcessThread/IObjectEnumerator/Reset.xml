<?xml version = "1.0" encoding="GB2312" ?>
    <?xml:stylesheet type="text/xsl" href="/xsl/xsl_c/methodmanual.xsl"?><manpage>
<sample url="sdk\operating_system\system_com_interface\IObjectEnumerator">Reset</sample>
<volume>对象枚举器</volume>
<interface>IObjectEnumerator</interface><method>Reset</method>
    <description>
        <para>
    重置枚举器到初始状态。
        </para>
    </description>
    <syntax_nopara>
        <return_val> ECode </return_val>
    	<NoArguments/>
    </syntax_nopara>

	<return>
	<table>
	    <th>
		<td>返回值</td>
		<td>描述</td>
	    </th>
	    <tr>
		<td>NOERROR</td>
		<td>方法调用成功</td>
	    </tr>
	</table>
	<para>参见<link url="../../../../../car_technology/fundamental/development_environment/car/ECode.htm">ECode</link>相关帮助。</para>
    </return>

	<remarks>
		<para> 在创建一个对象枚举器或者调用Reset方法后，都会使对象枚举器指向对象集合的第一个对象之前。此时调用<link url="Current.htm">Current</link>方法会返回错误信息。所以如果要获取任意一个对象的接口指针，必须通过调用<link url="MoveNext.htm">MoveNext</link>方法将对象枚举器后移并指向相应的对象，再调用<link url="Current.htm">Current</link>方法。</para>
	</remarks>

    <requirements>
        <system>
            <system_name>
				Windows 2000 或更高版本；Elastos操作系统
			</system_name>
        </system>
    </requirements>
    <example>
<pre>
//==========================================================================
//
// Description : The following example demonstrates the using of the
//               IObjectEnumerator.
//
//==========================================================================

#include &lt;elastos.h&gt;
#include &lt;stdio.h&gt;
using namespace Elastos;

int main()
{
    IProcess *iProc;

    // Gets the current process
    iProc = CProcess::GetCurrent();

    // Gets the module enumerator
    ECode ec;
    IObjectEnumerator   *iMods;
    ec = iProc-&gt;GetAllModules ((IObjectEnumerator **)&amp;iMods);
    if (FAILED(ec)) {
        printf(&quot;Get module enumerator failed, ec = 0x%08x.\n&quot;, ec);
        iProc-&gt;Release();
        return -1;
    }

    iProc-&gt;Release();

    // Resets the enumerator to the initial state
    ec = iMods-&gt;Reset();
    if (FAILED(ec)) {
        printf(&quot;Process enumerator Reset failed, ec = 0x%08x.\n&quot;, ec);
        iMods-&gt;Release();
        return -1;
    }

    printf(&quot;All modules in the process:\n&quot;);
    // enum the moudle
    // Advances the pointer of object enumerator to the next object
    Boolean bSucceeded;
    ec = iMods-&gt;MoveNext(&amp;bSucceeded);
    while (SUCCEEDED(ec) &amp;&amp; bSucceeded) {
        IModule  *iMod;
        // Gets the current object of the enumerator
        ec = iMods-&gt;Current((IInterface **)&amp;iMod);
        if (FAILED(ec)) {
            printf(&quot;Enumerate current module failed, ec = 0x%08x.\n&quot;, ec);
            iMods-&gt;Release();
            return -1;
        }

        WStringBuf_&lt;200&gt; ewsbName;
        //Gets the name of the module
        ec = iMod-&gt;GetName(&amp;ewsbName);
        if (FAILED(ec)) {
            printf(&quot;Get module name failed, ec = 0x%08x.\n&quot;, ec);

            iMods-&gt;Release();
            iMod-&gt;Release();
            return -1;
        }
        printf(&quot;    Module Name : %12S\n&quot;, (wchar_t*)ewsbName);

        iMod-&gt;Release();
        ec = iMods-&gt;MoveNext(&amp;bSucceeded);
    }

    iMods-&gt;Release();

    return 0;
}
</pre>
    </example>
<result>
All modules in the process:
    Module Name :     Test.exe
    Module Name :    ntdll.dll
    Module Name : kernel32.dll
    Module Name :  elastos.dll
    Module Name :   elaura.dll
    Module Name :  MSVCR80.dll
    Module Name :   msvcrt.dll
    Module Name :    ole32.dll
    Module Name :    GDI32.dll
    Module Name :   USER32.dll
    Module Name : ADVAPI32.dll
    Module Name :   RPCRT4.dll
    Module Name :    PSAPI.DLL
    Module Name : bootmods.dll
    Module Name :  environ.dll
    Module Name : ela_malloc.dll
    Module Name : ElCRuntime.dll
    Module Name : ElMathLib.dll
    Module Name :    IMM32.DLL
    Module Name :      LPK.DLL
    Module Name :    USP10.dll
</result>
</manpage>